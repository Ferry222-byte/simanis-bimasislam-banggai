<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIMANIS Banggai - Sistem Manajemen Bimas Islam</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        
        /* Custom Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        
        /* Animasi Teks Berjalan (Marquee) */
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .animate-marquee {
            display: inline-block;
            white-space: nowrap;
            /* Durasi diubah dari 35s menjadi 20s agar lebih cepat */
            animation: marquee 20s linear infinite; 
        }
        /* Pause saat di-hover agar mudah dibaca */
        .animate-marquee:hover {
            animation-play-state: paused;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #10b981; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #059669; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- DEFINISI IKON INTERNAL (Menghindari Error Library Eksternal) ---
        // Semua ikon dikonversi menjadi komponen React SVG murni
        const Icons = {
            LayoutDashboard: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>,
            Calendar: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Users: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            FileText: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></svg>,
            CheckCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            Activity: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>,
            BarChart3: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>,
            MapPin: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>,
            Menu: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
            X: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            TrendingUp: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
            Edit2: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
            Save: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
            Trash2: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>,
            RefreshCw: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            Clock: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            HeartHandshake: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/><path d="M12 5 9.04 7.96a2.17 2.17 0 0 0 0 3.08v0c.82.82 2.13.85 3 .07l2.07-1.9a2.82 2.82 0 0 1 3.15-.49v0c1.31.55 2.08 1.98 1.94 3.38"/></svg>,
            Link: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>,
            Globe: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>,
            ExternalLink: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
        };

        const { 
            LayoutDashboard, Calendar, Users, FileText, CheckCircle, Activity, 
            BarChart3, MapPin, Menu, X, TrendingUp, Edit2, Save, Trash2, 
            RefreshCw, Clock, HeartHandshake, Link, Globe, ExternalLink
        } = Icons;

        // --- KOMPONEN WIDGET SHALAT (RUNNING TEXT) ---
        const PrayerWidget = () => {
            const [prayerTimes, setPrayerTimes] = useState(null);
            const [currentDate, setCurrentDate] = useState("");

            useEffect(() => {
                const fetchPrayer = async () => {
                    try {
                        const date = new Date();
                        const today = date.toISOString().split('T')[0];
                        const res = await fetch(`https://api.aladhan.com/v1/timings/${today.split('-').reverse().join('-')}?latitude=-0.9516&longitude=122.7886&method=20`);
                        const data = await res.json();
                        setPrayerTimes(data.data.timings);
                        setCurrentDate(data.data.date.readable);
                    } catch (error) {
                        console.error("Gagal ambil jadwal shalat", error);
                        setPrayerTimes({ Fajr: "04:30", Dhuhr: "11:55", Asr: "15:15", Maghrib: "18:00", Isha: "19:10" });
                    }
                };
                fetchPrayer();
            }, []);

            if (!prayerTimes) return <div className="animate-pulse bg-emerald-800/20 h-32 rounded-xl"></div>;

            const prayers = [
                { name: "Subuh", time: prayerTimes.Fajr, icon: "üåÖ" },
                { name: "Dzuhur", time: prayerTimes.Dhuhr, icon: "‚òÄÔ∏è" },
                { name: "Ashar", time: prayerTimes.Asr, icon: "üå§Ô∏è" },
                { name: "Maghrib", time: prayerTimes.Maghrib, icon: "üåá" },
                { name: "Isya", time: prayerTimes.Isha, icon: "üåô" }
            ];

            return (
                <div className="bg-gradient-to-br from-emerald-900 to-emerald-700 rounded-xl p-6 text-white shadow-lg relative overflow-hidden flex flex-col justify-between h-full min-h-[160px]">
                    <div className="absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-10 -mt-10 blur-2xl"></div>
                    <div className="flex justify-between items-start z-10 mb-4">
                        <div>
                            <p className="text-emerald-300 text-xs font-medium uppercase tracking-wider mb-1">Jadwal Shalat ‚Ä¢ Luwuk</p>
                            <p className="text-xs text-emerald-100 opacity-80">{currentDate}</p>
                        </div>
                        <div className="bg-white/10 p-2 rounded-lg backdrop-blur-sm">
                            <Clock size={18} className="text-white" />
                        </div>
                    </div>
                    <div className="flex-1 flex items-center overflow-hidden w-full bg-emerald-950/30 rounded-lg py-3 px-2 border border-emerald-500/20 backdrop-blur-sm relative">
                        <div className="animate-marquee w-full whitespace-nowrap">
                            {prayers.map((p, idx) => (
                                <span key={idx} className="inline-flex items-center mx-6 text-lg font-bold">
                                    <span className="mr-2 text-xl">{p.icon}</span> 
                                    <span className="text-emerald-200 mr-2">{p.name}:</span> 
                                    <span className="text-white">{p.time}</span>
                                </span>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // --- DATA DEFAULT (Sebagai Fallback) ---
        const defaultRKT = [
            { id: 1, pilar: "Layanan KUA Prima", kegiatan: "Standardisasi Layanan KUA (Service Excellence)", target: "23 KUA", tw: "TW I", status: "Selesai", progress: 100 },
            { id: 2, pilar: "Layanan KUA Prima", kegiatan: "Digitalisasi & Validasi Data SIMKAH", target: "100% Data", tw: "TW I-IV", status: "Proses", progress: 80 },
            { id: 3, pilar: "Keluarga Sakinah", kegiatan: "Bimbingan Perkawinan (Bimwin) Catin", target: "50 Angkatan", tw: "TW I-IV", status: "Proses", progress: 45 },
            { id: 4, pilar: "Penyuluhan Agama", kegiatan: "Majelis Taklim Berbadan Hukum", target: "100 MT", tw: "TW I-IV", status: "Proses", progress: 60 },
            { id: 5, pilar: "Moderasi Beragama", kegiatan: "Kampung Moderasi Beragama (KMB)", target: "2 Desa Binaan", tw: "TW II", status: "Proses", progress: 50 },
        ];

        const defaultKUA = [
            { id: 1, nama: "KUA Kec. Moilong", kepala: "H. Mohamad Zulkarnain, S.Ag, MA", status: "Prima", layanan: "Online" },
            { id: 2, nama: "KUA Kec. Batui Selatan", kepala: "N.A Sustiono, S.HI", status: "Prima", layanan: "Online" },
            { id: 3, nama: "KUA Kec. Luwuk Selatan", kepala: "H. Sapri Mariadjang, S.HI", status: "Prima", layanan: "Online" },
            { id: 4, nama: "KUA Kec. Masama", kepala: "Ismail, S.HI", status: "Siaga", layanan: "Hybrid" },
            { id: 5, nama: "KUA Kec. Simpang Raya", kepala: "Ahmad Zaenal Ihrom, S.Th.I", status: "Prima", layanan: "Online" },
            { id: 6, nama: "KUA Kec. Bunta", kepala: "Saifudin, S.HI", status: "Prima", layanan: "Online" },
            { id: 7, nama: "KUA Kec. Pagimana", kepala: "Suriyanto S.FIL.I", status: "Siaga", layanan: "Hybrid" },
            { id: 8, nama: "KUA Kec. Nuhon", kepala: "ISMAIL M. AMIR A. S.FIL.I", status: "Prima", layanan: "Online" },
            { id: 9, nama: "KUA Kec. Toili", kepala: "H. Muhammad Saleh, S.Ag", status: "Prima", layanan: "Online" },
            { id: 10, nama: "KUA Kec. Kintom", kepala: "Usman Jayadi, S.FIL.I", status: "Prima", layanan: "Online" },
            { id: 11, nama: "KUA Kec. Toili Barat", kepala: "Mashuri Unok, S.Ag", status: "Siaga", layanan: "Hybrid" },
            { id: 12, nama: "KUA Kec. Nambo", kepala: "Syarifudin Dailaa, S.Fil.I", status: "Prima", layanan: "Online" },
            { id: 13, nama: "KUA Kec. Lamala", kepala: "Awaludin Maserang, S.Pd.I", status: "Prima", layanan: "Online" },
            { id: 14, nama: "KUA Kec. Batui", kepala: "Andi Muammar Andi Rasyid, S.Hi", status: "Prima", layanan: "Online" },
            { id: 15, nama: "KUA Kec. Balantak", kepala: "Muhlis Isini, S.Ag", status: "Siaga", layanan: "Hybrid" },
            { id: 16, nama: "KUA Kec. Lobu", kepala: "Bakhtiar Lakita, S.Ag", status: "Prima", layanan: "Online" },
            { id: 17, nama: "KUA Kec. Balantak Utara", kepala: "Ahmad Saleh, S.Pd.I", status: "Perlu Perhatian", layanan: "Manual" },
        ];

        // --- MAIN APP COMPONENT ---
        const SIMANISApp = () => {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [editRowId, setEditRowId] = useState(null);
            const [editKuaId, setEditKuaId] = useState(null);

            // --- STATE DENGAN LOCAL STORAGE (FITUR SIMPAN DATA) ---
            
            // 1. Inisialisasi State: Cek LocalStorage dulu, jika kosong pakai Default
            const [rktData, setRktData] = useState(() => {
                const savedRKT = localStorage.getItem('simanis_rkt_data');
                return savedRKT ? JSON.parse(savedRKT) : defaultRKT;
            });

            const [kuaData, setKuaData] = useState(() => {
                const savedKUA = localStorage.getItem('simanis_kua_data');
                return savedKUA ? JSON.parse(savedKUA) : defaultKUA;
            });

            // 2. Simpan Otomatis: Setiap kali data berubah, simpan ke LocalStorage
            useEffect(() => {
                localStorage.setItem('simanis_rkt_data', JSON.stringify(rktData));
            }, [rktData]);

            useEffect(() => {
                localStorage.setItem('simanis_kua_data', JSON.stringify(kuaData));
            }, [kuaData]);

            const getGreeting = () => {
                const hour = new Date().getHours();
                if (hour < 11) return "Semangat Pagi! Awali dengan Basmalah ‚òÄÔ∏è";
                if (hour < 15) return "Selamat Siang, Tetap Produktif! üå§Ô∏è";
                if (hour < 18) return "Selamat Sore, Menjelang Maghrib üåá";
                return "Selamat Malam, Istirahat yang Cukup üåô";
            };

            // Handlers Update Data
            const handleUpdateRKT = (id, field, value) => {
                setRktData(rktData.map(item => item.id === id ? { ...item, [field]: value } : item));
            };
            const handleUpdateKUA = (id, field, value) => {
                setKuaData(kuaData.map(item => item.id === id ? { ...item, [field]: value } : item));
            };

            // Fungsi Reset Data (Kembali ke Pengaturan Pabrik)
            const handleResetData = () => {
                if(confirm("Apakah Anda yakin ingin mereset semua data ke kondisi awal? Data yang Anda edit akan hilang.")) {
                    localStorage.removeItem('simanis_rkt_data');
                    localStorage.removeItem('simanis_kua_data');
                    setRktData(defaultRKT);
                    setKuaData(defaultKUA);
                    alert("Data berhasil direset!");
                }
            };

            // --- SUB-VIEWS ---

            const DashboardView = () => (
                <div className="space-y-6 animate-fade-in">
                    {/* Top Row: Prayer & Quick Stats */}
                    <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
                        {/* Widget Shalat - Takes 1 Column */}
                        <PrayerWidget />

                        {/* Stats - Takes 3 Columns */}
                        <div className="md:col-span-2 lg:col-span-3 grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-center justify-between">
                                <div>
                                    <p className="text-slate-500 text-sm">Program Unggulan</p>
                                    <h3 className="text-2xl font-bold text-slate-800">{rktData.length}</h3>
                                </div>
                                <div className="bg-emerald-100 p-3 rounded-lg text-emerald-600"><FileText /></div>
                            </div>
                            <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-center justify-between">
                                <div>
                                    <p className="text-slate-500 text-sm">KUA Online</p>
                                    <h3 className="text-2xl font-bold text-slate-800">{kuaData.filter(k=>k.layanan==='Online').length}</h3>
                                </div>
                                <div className="bg-blue-100 p-3 rounded-lg text-blue-600"><Activity /></div>
                            </div>
                            <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-center justify-between">
                                <div>
                                    <p className="text-slate-500 text-sm">Peristiwa Nikah</p>
                                    <h3 className="text-2xl font-bold text-slate-800">1,450+</h3>
                                </div>
                                <div className="bg-pink-100 p-3 rounded-lg text-pink-600"><HeartHandshake /></div>
                            </div>

                             {/* PORTAL TAUTAN PUSAT (New Feature) */}
                            <div className="sm:col-span-3 bg-white border border-slate-200 rounded-xl p-4 flex flex-col md:flex-row items-center justify-between gap-4">
                                <div className="flex items-center gap-3">
                                    <div className="bg-emerald-50 p-2 rounded-full"><Globe className="text-emerald-600" size={20}/></div>
                                    <span className="font-bold text-slate-700 text-sm">Akses Cepat Kemenag RI:</span>
                                </div>
                                <div className="flex gap-2 flex-wrap justify-center md:justify-end w-full">
                                    <a href="https://bimasislam.kemenag.go.id" target="_blank" className="flex items-center gap-2 px-4 py-2 bg-slate-50 hover:bg-emerald-50 text-slate-700 hover:text-emerald-700 border border-slate-200 rounded-lg text-xs font-medium transition">
                                        <ExternalLink size={14}/> Bimas Islam Pusat
                                    </a>
                                    <a href="https://simkah.kemenag.go.id" target="_blank" className="flex items-center gap-2 px-4 py-2 bg-slate-50 hover:bg-emerald-50 text-slate-700 hover:text-emerald-700 border border-slate-200 rounded-lg text-xs font-medium transition">
                                        <ExternalLink size={14}/> SIMKAH Web
                                    </a>
                                    <a href="https://kemenag.go.id" target="_blank" className="flex items-center gap-2 px-4 py-2 bg-slate-50 hover:bg-emerald-50 text-slate-700 hover:text-emerald-700 border border-slate-200 rounded-lg text-xs font-medium transition">
                                        <ExternalLink size={14}/> Portal Kemenag
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Main Monitoring Area */}
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2 bg-white rounded-xl shadow-sm border border-slate-100 p-6">
                            <div className="flex justify-between items-center mb-6">
                                <h3 className="font-bold text-slate-800 flex items-center gap-2">
                                    <TrendingUp className="text-emerald-600"/> Progres Program Prioritas
                                </h3>
                                <button onClick={()=>setActiveTab('rkt')} className="text-xs text-emerald-600 font-medium hover:underline">Lihat Semua</button>
                            </div>
                            <div className="space-y-5">
                                {rktData.slice(0,4).map((item, idx) => (
                                    <div key={idx}>
                                        <div className="flex justify-between text-sm mb-1">
                                            <span className="font-medium text-slate-700">{item.kegiatan}</span>
                                            <span className="font-bold text-emerald-600">{item.progress}%</span>
                                        </div>
                                        <div className="w-full bg-slate-100 rounded-full h-2">
                                            <div className="bg-emerald-500 h-2 rounded-full transition-all duration-700" style={{width: `${item.progress}%`}}></div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-sm border border-slate-100 p-6">
                            <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                                <Clock className="text-slate-400" size={18}/> Agenda Dekat
                            </h3>
                            <div className="space-y-4">
                                {[
                                    {d: "19 Des", t: "Bimwin Catin Mandiri", l: "KUA Luwuk"},
                                    {d: "21 Des", t: "Sidang Isbat Nikah", l: "Kec. Pagimana"},
                                    {d: "25 Des", t: "Laporan Bulanan", l: "Bimas Islam"}
                                ].map((ev, i) => (
                                    <div key={i} className="flex gap-3 items-start border-b border-slate-50 pb-3 last:border-0">
                                        <div className="bg-emerald-50 text-emerald-700 rounded px-2 py-1 text-center min-w-[50px]">
                                            <span className="block text-xs font-bold">{ev.d.split(' ')[1]}</span>
                                            <span className="block text-lg font-bold leading-none">{ev.d.split(' ')[0]}</span>
                                        </div>
                                        <div>
                                            <p className="text-sm font-medium text-slate-800">{ev.t}</p>
                                            <p className="text-xs text-slate-500 flex items-center gap-1 mt-1"><MapPin size={10}/> {ev.l}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );

            const RKTView = () => (
                <div className="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden animate-fade-in">
                    <div className="p-6 border-b border-slate-100 bg-slate-50/50">
                        <h2 className="font-bold text-lg text-slate-800">Manajemen RKT (Editable)</h2>
                        <p className="text-sm text-slate-500">Klik ikon pensil untuk mengubah status/progres.</p>
                    </div>
                    <div className="overflow-x-auto">
                        <table className="w-full text-sm text-left">
                            <thead className="bg-slate-50 text-slate-500 border-b border-slate-200 font-medium">
                                <tr>
                                    <th className="px-6 py-4">Kegiatan</th>
                                    <th className="px-6 py-4">Target</th>
                                    <th className="px-6 py-4">Status</th>
                                    <th className="px-6 py-4">Progres</th>
                                    <th className="px-6 py-4">Aksi</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-slate-100">
                                {rktData.map(item => (
                                    <tr key={item.id} className={editRowId === item.id ? "bg-amber-50" : "hover:bg-slate-50"}>
                                        <td className="px-6 py-4">
                                            <span className="text-xs font-bold text-emerald-600 block mb-1">{item.pilar}</span>
                                            <span className="text-slate-800 font-medium">{item.kegiatan}</span>
                                        </td>
                                        <td className="px-6 py-4 text-slate-600">{item.target}</td>
                                        <td className="px-6 py-4">
                                            {editRowId === item.id ? (
                                                <select className="border rounded p-1 text-xs" value={item.status} onChange={(e)=>handleUpdateRKT(item.id, 'status', e.target.value)}>
                                                    <option>Belum</option><option>Proses</option><option>Selesai</option>
                                                </select>
                                            ) : (
                                                <span className={`px-2 py-1 rounded-full text-xs font-bold ${
                                                    item.status === 'Selesai' ? 'bg-green-100 text-green-700' :
                                                    item.status === 'Proses' ? 'bg-blue-100 text-blue-700' : 'bg-slate-100 text-slate-600'
                                                }`}>{item.status}</span>
                                            )}
                                        </td>
                                        <td className="px-6 py-4 w-48">
                                            {editRowId === item.id ? (
                                                <div className="flex gap-2 items-center">
                                                    <input type="range" className="w-24" value={item.progress} onChange={(e)=>handleUpdateRKT(item.id, 'progress', e.target.value)} />
                                                    <span className="text-xs font-bold">{item.progress}%</span>
                                                </div>
                                            ) : (
                                                <div className="w-full bg-slate-200 rounded-full h-2">
                                                    <div className="bg-emerald-500 h-2 rounded-full" style={{width: `${item.progress}%`}}></div>
                                                </div>
                                            )}
                                        </td>
                                        <td className="px-6 py-4">
                                            <button onClick={() => setEditRowId(editRowId === item.id ? null : item.id)} className="p-2 rounded hover:bg-slate-100 text-slate-500 hover:text-emerald-600">
                                                {editRowId === item.id ? <Save size={16}/> : <Edit2 size={16}/>}
                                            </button>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );

            const KUAView = () => (
                <div className="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden animate-fade-in">
                    <div className="p-6 border-b border-slate-100 flex justify-between items-center">
                        <div>
                            <h2 className="font-bold text-lg text-slate-800">Database KUA Kecamatan</h2>
                            <p className="text-sm text-slate-500">Monitoring Kondisi 17 KUA di Banggai</p>
                        </div>
                        <input type="text" placeholder="Cari KUA..." className="border border-slate-200 rounded-lg px-3 py-2 text-sm focus:outline-emerald-500"/>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6">
                        {kuaData.map(kua